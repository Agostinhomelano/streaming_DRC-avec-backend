<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Liste des paiement - Admin</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
  <style>
    .admin-table {
  width: 100%;
  border-collapse: collapse;
  margin: 2rem 0;
  background: rgba(255,255,255,0.15);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}

.admin-table th, .admin-table td {
  padding: 0.9rem 1rem;
  text-align: left;
}

.admin-table th {
  background: #00A8E1;
  color: #fff;
  font-weight: bold;
  font-size: 1rem;
  text-align: center;
}

.admin-table tr {
  border-bottom: 1px solid #e50914;
}

.admin-table tr:last-child {
  border-bottom: none;
}

.admin-table td {
  background: rgba(255,255,255,0.10);
  color: #222;
}

.admin-table tr:hover td {
  background: rgba(224, 9, 20, 0.08);
}

.btn-admin {
  display: inline-block;
  padding: 6px 16px;
  background: #e50914;
  color: #fff;
  border-radius: 6px;
  text-decoration: none;
  font-weight: bold;
  transition: background 0.3s;
  font-size: 0.95rem;
}

.btn-admin:hover {
  background: #b20710;
}
/* --- MODALE (overlay) --- */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      animation: fadeIn 0.3s ease-in-out;
    }

    .modal h2 {
      margin-bottom: 15px;
      color: #e50914;
    }

    .modal button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      margin: 10px;
      font-size: 1rem;
      cursor: pointer;
      transition: 0.3s;
    }

    .btn-cancel {
      background: #ccc;
    }
    .btn-cancel:hover {
      background: #aaa;
    }

    .btn-confirm {
      background: #e50914;
      color: #fff;
    }
    .btn-confirm:hover {
      background: #b20710;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    .num_a{
      text-decoration: none;
      color: #00A8E1;
    }
    .num_a:hover{
      color: black;
    }
@media (max-width:992px) {
  body{
    min-height: 120vh;
  }
  .admin-container{
    padding: 10px 8px 20px 5px ;
  }
}
@media (max-width:500px) {
  body{
    min-height: 150vh;
  }
  .admin-table, .admin-table thead, .admin-table tbody, .admin-table th, .admin-table tr {
        display: block;
        width: 100%;
      }
      .admin-table thead {
        display: none;
      }

      .admin-table tr {
        margin-bottom: 15px;
        border-radius: 10px;
        background:rgba(255,255,255,0.15);;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        padding: 10px;
        width: 93%;
      }
      .admin-table tr:hover td {
        background: rgba(224, 9, 20, 0.21);
      }
      .admin-table td {
        display: flex;
        justify-content:first baseline;
        align-items: center;
        padding: 10px;
        gap: 20px;
        font-size: 0.9rem;
        border: none;
        border-bottom: 1px solid #f0f0f079;
        vertical-align: middle;
        text-align: center;
        width: 94%;
      }

      .admin-table td:last-child {
        border-bottom: none;
      }

      .admin-table td::before {
        content: attr(data-label);
        font-weight: bold;
        color: #00A8E1;
      }
    }
@media (max-width:400px) {
  body{
    min-height: 250vh;
  }
  .admin-table, .admin-table thead, .admin-table tbody, .admin-table th, .admin-table tr {
        display: block;
        width: 100%;
      }
      .admin-table thead {
        display: none;
      }

      .admin-table tr {
        margin-bottom: 15px;
        border-radius: 10px;
        background:rgba(255,255,255,0.15);;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        padding: 10px;
        width: 93%;
      }

      .admin-table td {
        display: flex;
        justify-content:first baseline;
        align-items: center;
        padding: 10px;
        gap: 20px;
        font-size: 0.9rem;
        border: none;
        border-bottom: 1px solid #f0f0f079;
        vertical-align: middle;
        text-align: center;
        width: 94%;
      }

      .admin-table td:last-child {
        border-bottom: none;
      }

      .admin-table td::before {
        content: attr(data-label);
        font-weight: bold;
        color: #00A8E1;
      }
    }
    @media (max-width:350px) {
      body{
        min-height: 350vh;
    }
}
  </style>
</head>
<body>
  <div class="admin-container">
    <h1>Liste des paiements</h1>
    <table class="admin-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Utilisateur</th>
          <th>Service</th>
          <th>moyen de paiement</th>
          <th>nom du compte</th>
          <th>numero du compte</th>
          <th>montant versé</th>
          <th>Statut</th>
          <th>Date du paiement</th>
          <th></th>
        </tr>
      </thead>
      {%if paiements %}
      <tbody>
        {% for paiement in paiements %}
        <tr>
          
          <td>{{ paiement.utilisateur_id }}</td>
          <td>{{ paiement.utilisateur.nom }}</td>
          <td>{{ paiement.service}}</td>
          <td>{{ paiement.moyen}}</td>
          <td>{{ paiement.nom_compte}}</td>
          <td><a class="num_a" href="https://wa.me/{{ paiement.numero}}" target="_blank">{{ paiement.numero}}</a></td>
          <td>{{ paiement.montant}}</td>
          <td style="color: rgb(202, 29, 29);">{{ "Actif" if paiement.statut else "Inactif" }}</td>
          <td>{{ paiement.date_paiement.strftime("%Y-%m-%d") }}</td>          
          <td>
            <button class="btn-admin btn-gerer btn-primary" data-bs-toggel="modal" data-bs-target="#modalPaiement" data-id="{{paiement.id}}" data-nom="{{ paiement.nom }}">Gérer</button>
          </td>
        </tr>
        {% else %}
          <p style="color: white;">aucun paiement</p>
        {% endfor %}
      </tbody>
      {% endif %}
    </table>
    <a href="{{ url_for('accueil_admin') }}" class="btn-retour">Retour au tableau de bord</a>
    <div class="modal" id="confirmModal">
      <div class="modal-content">
        <h2>⚠ Confirmation</h2>
        <p>Voulez-vous vraiment Valider ce paiement ?</p>
        <button type="button" class="btn-admin btn-confirm">valider</button>
        <button class="btn-admin btn-delete">Supprimer</button>
        <button class="btn-cancel">Annuler</button>
        <!-- <button class="btn-confirm">Valider</button> -->
      </div>
  </div>
  <script>
  const modal = document.getElementById("confirmModal");
  const btnCancel = modal.querySelector(".btn-cancel");
  const btnConfirm = modal.querySelector(".btn-confirm");
  const btnDelete = modal.querySelector(".btn-delete");
  let paiementID = null;

  // Pour chaque bouton "Gérer"
  document.querySelectorAll(".btn-gerer").forEach(button => {
    button.addEventListener("click", () => {
      paiementID = button.getAttribute("data-id");
      modal.style.display = "flex";
    });
  });

  // Fermer si on clique sur Annuler
  btnCancel.addEventListener("click", () => {
    modal.style.display = "none";
    paiementID = null;
  });

  // Valider le paiement
  btnConfirm.addEventListener("click", () => {
    if (paiementID) {
      window.location.href = `/admin/valider_paiement/${paiementID}`;
    }
  });

  // Supprimer le paiement
  btnDelete.addEventListener("click", () => {
    if (paiementID) {
      window.location.href = `/admin/liste_paiement/supprimer_paiement/${paiementID}`;
    }
  });
</script>
 </body>